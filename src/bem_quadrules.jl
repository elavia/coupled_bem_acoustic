# ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#	
#	Quadratures rules
#	
# ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

# v. 13/8/20

# ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
# Index:

# 	glt7( )
# 	glt7x3( WQOFF::Array{Float64,1}, XQOFF::Array{Float64,1}, YQOFF::Array{Float64,1} )
# 	QR_cqutm6( )
# 	QR_cqutm8( )
# 	QR_cqutm9( )
# 	QR_cqutm11( )
# 	QR_cquts7( )
# 	cqutm9( )
# 	cqutm11( )
# 	cquts7( )
# 	cquts6( )
# 	cquts8()

# ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

	# Regla de cuadratura de 7 puntos para integrar en el triángulo.
	# Se tomó del código de S. Kirkup
	function glt7( )
		WQ = [ 0.225000000000000, 0.125939180544827, 0.125939180544827, 0.125939180544827,
			0.132394152788506, 0.132394152788506, 0.132394152788506 ] ;
		XQ = [ 0.333333333333333, 0.797426985353087, 0.101286507323456, 0.101286507323456,
			0.470142064105115, 0.470142064105115, 0.059715871789770 ] ;
		YQ = [ 0.333333333333333, 0.101286507323456, 0.797426985353087, 0.101286507323456,
			0.470142064105115, 0.059715871789770, 0.470142064105115 ] ; 
		return WQ, XQ, YQ 
	end 
	
	# Función que da una regla de cuadratura de 21 puntos a partir de la de 7
	# Es para triángulos donde el punto es parte del panel
	# Toma 'NQ' nro de puntos de la regla original, 'XQOFF', 'YQOFF' abscisas y ordenadas
	# de la regla original y los pesos 'WQOFF'
	function glt7x3( WQOFF::Array{Float64,1}, XQOFF::Array{Float64,1}, YQOFF::Array{Float64,1})
		NQOFF = length( WQOFF ) ;
		XQON = zeros( Float64, 3*NQOFF ) ; # x-Abscissae of the actual quadrature rule
		YQON = zeros( Float64, 3*NQOFF ) ; # y-Abscissae of the actual quadrature rule
		WQON = zeros( Float64, 3*NQOFF ) ; # Weights of the actual quadrature rule
		for IQ = 1 : NQOFF 
			XQON[ IQ ] = XQOFF[ IQ ]/3 + YQOFF[ IQ ] ;
			YQON[ IQ ] = XQOFF[ IQ ]/3 ;
			WQON[ IQ ] = WQOFF[ IQ ]/3 ;
			XQON[ IQ + NQOFF ] = XQOFF[ IQ ]/3 ;
			YQON[ IQ + NQOFF ] = XQOFF[ IQ ]/3 + YQOFF[ IQ ] ;
			WQON[ IQ + NQOFF ] = WQOFF[ IQ ]/3 ;
			XQON[ IQ + 2*NQOFF ] = ( 1/3 )*( 1.0 + 2*XQOFF[ IQ ]- YQOFF[ IQ ] ) ;
			YQON[ IQ + 2*NQOFF ] = ( 1/3 )*( 1.0 - XQOFF[ IQ ] + 2*YQOFF[ IQ ] ) ;
			WQON[ IQ + 2*NQOFF ] = WQOFF[IQ]/3 ;
		end 
		return WQON, XQON, YQON ; 
	end

	# Regla de cuadratura de orden 6 y 20 puntos. Retorna matriz [x y w]
	function QR_cqutm6( )
		return [ 0.04691007703066802	0.03218131275309969	0.01934361681488753
		 	0.04691007703066802	0.16144895987780034	0.04073225919814655
			0.04691007703066802	0.3628321906431466	0.052830437300749475
		 	0.04691007703066802	0.5902577323261854	0.052830437300749475
		 	0.04691007703066802	0.7916409630915315	0.04073225919814655
		 	0.04691007703066802	0.9209086102162323	0.01934361681488753
		 	0.23076534494715845	0.036084856923188136	0.04361560494149611
		 	0.23076534494715845	0.1775127005185774	0.08811021594794127
		 	0.23076534494715845	0.38461732752642075	0.1047261184711055
		 	0.23076534494715845	0.591721954534264	0.08811021594794127
		 	0.23076534494715845	0.7331497981296533	0.04361560494149611
		 	0.5	0.03471592210148686	0.04947268908621566
		 	0.5	0.16500473910378594	0.09274953313600658
		 	0.5	0.33499526089621406	0.09274953313600658
		 	0.5	0.4652840778985131	0.04947268908621566
		 	0.7692346550528415	0.026007638687363766	0.03068080840260726
		 	0.7692346550528415	0.11538267247357922	0.049089293444171615
		 	0.7692346550528415	0.20475770625979467	0.03068080840260726
		 	0.9530899229693319	0.009913265714652876	0.005557129214311029
		 	0.9530899229693319	0.03699681131601514	0.005557129214311029 ] ;
	end	
    
	# Regla de cuadratura de orden 8 y 35 puntos. Retorna matriz [x y w]
	function QR_cqutm8()
		return [0.025446043828620757	0.019349838725229655	0.006387018852325163
				0.025446043828620757	0.09907974442940629	0.01403114093617805
				0.025446043828620757	0.23119713349557092	0.019793334318045034
				0.025446043828620757	0.39789349981418054	0.02288354891574632
				0.025446043828620757	0.5766604563571986	0.02288354891574632
				0.025446043828620757	0.7433568226758083	0.019793334318045034
				0.025446043828620757	0.8754742117419729	0.01403114093617805
				0.025446043828620757	0.9552041174461495	0.006387018852325163
				0.12923440720030277	0.02215753943883603	0.015768538755504602
				0.12923440720030277	0.1125328751958891	0.03406221923918308
				0.12923440720030277	0.2586847994878376	0.04649884946144249
				0.12923440720030277	0.4353827963998486	0.050898616117170954
				0.12923440720030277	0.6120807933118596	0.04649884946144249
				0.12923440720030277	0.7582327176038082	0.03406221923918308
				0.12923440720030277	0.8486080533608612	0.015768538755504602
				0.29707742431130146	0.023734351506914716	0.02299148668475681
				0.29707742431130146	0.11907178534214391	0.04841365521020297
				0.29707742431130146	0.26759588139917845	0.0627933393932423
				0.29707742431130146	0.4353266942895201	0.0627933393932423
				0.29707742431130146	0.5838507903465546	0.04841365521020297
				0.29707742431130146	0.6791882241817838	0.02299148668475681
				0.5	0.02345503851533401	0.024756441867095677
				0.5	0.11538267247357922	0.05001181210115829
				0.5	0.25	0.05944308390022676
				0.5	0.38461732752642075	0.05001181210115829
				0.5	0.47654496148466596	0.024756441867095677
				0.7029225756886985	0.020626633441003	0.01972912461745315
				0.7029225756886985	0.09803836578422202	0.03698741934690429
				0.7029225756886985	0.19903905852707945	0.03698741934690429
				0.7029225756886985	0.27645079087029845	0.01972912461745315
				0.8707655927996972	0.014564932915775331	0.010040989016623687
				0.8707655927996972	0.06461720360015138	0.016065582426597898
				0.8707655927996972	0.11466947428452744	0.010040989016623687
				0.9745539561713792	0.005377381787177773	0.0016474400621402676
				0.9745539561713792	0.020068662041442982	0.0016474400621402676 ];
	end

	# Regla de cuadratura de orden 9 y 44 puntos. Retorna matriz [x y w]
	function QR_cqutm9()
		return [ 0.019855071751231912	0.015603789881627896	0.004031966995326902
    			0.019855071751231912	0.08035663927218227	0.00896183208968381
		    	0.019855071751231912	0.18947601467730188	0.0129287189692663
		    	0.019855071751231912	0.33116478991611215	0.015495325539817254
		    	0.019855071751231912	0.49007246412438404	0.016382949250869517
		    	0.019855071751231912	0.648980138332656	0.015495325539817254
		    	0.019855071751231912	0.7906689135714662	0.0129287189692663
		    	0.019855071751231912	0.8997882889765858	0.00896183208968381
		    	0.019855071751231912	0.9645411383671402	0.004031966995326902
		    	0.10166676129318664	0.017836470911040323	0.010111327490140942
		    	0.10166676129318664	0.09133063094134085	0.022212782574513718
		    	0.10166676129318664	0.21311500343064044	0.031334945150309046
		    	0.10166676129318664	0.3667739011113349	0.036227082238771975
		    	0.10166676129318664	0.5315593375954785	0.036227082238771975
		    	0.10166676129318664	0.6852182352761729	0.031334945150309046
		    	0.10166676129318664	0.8070026077654725	0.022212782574513718
		    	0.10166676129318664	0.880496767795773	0.010111327490140942
		    	0.2372337950418355	0.019409382282356176	0.015491893912735213
		    	0.2372337950418355	0.09857563833019303	0.033464628211129784
		    	0.2372337950418355	0.22660061952067778	0.045683068931764194
		    	0.2372337950418355	0.38138310247908225	0.0500056456351725
		    	0.2372337950418355	0.5361655854374867	0.045683068931764194
		    	0.2372337950418355	0.6641905666279715	0.033464628211129784
    			0.2372337950418355	0.7433568226758083	0.015491893912735213
		    	0.4082826787521751	0.01997947907913758	0.018383655713702835
		    	0.4082826787521751	0.10023413715204454	0.0387108489950919
		    	0.4082826787521751	0.2252611078301697	0.05020863367154068
		    	0.4082826787521751	0.3664562134176553	0.05020863367154068
		    	0.4082826787521751	0.4914831840957804	0.0387108489950919
		    	0.4082826787521751	0.5717378421686874	0.018383655713702835
		    	0.591717321247825	0.01915257191055202	0.0175417711949084
		    	0.591717321247825	0.09421749319819557	0.035437070061643344
		    	0.591717321247825	0.20414133937608755	0.04211982410458773
		    	0.591717321247825	0.3140651855539795	0.035437070061643344
		    	0.591717321247825	0.3891301068416231	0.0175417711949084
		    	0.7627662049581645	0.01647157989702492	0.012943995010482759
		    	0.7627662049581645	0.07828940091495819	0.024266914055245434
		    	0.7627662049581645	0.15894439412687733	0.024266914055245434
		    	0.7627662049581645	0.22076221514481056	0.012943995010482759
		    	0.8983332387068134	0.01145801331145765	0.006280210984973098
		    	0.8983332387068134	0.05083338064659332	0.010048337575956955
		    	0.8983332387068134	0.09020874798172898	0.006280210984973098
		    	0.9801449282487681	0.004195870365439416	0.0010049499256587963
		    	0.9801449282487681	0.015659201385792496	0.0010049499256587963 ] ;
	end

	# Regla de cuadratura de orden 11 y 65 puntos. Matriz [x y w]
	function QR_cqutm11()
		return [ 0.013046735741414128	0.010743648455019322	0.0018315376345417456
                   	0.013046735741414128	0.05573196790787835	0.004131688397056032
                       	0.013046735741414128	0.13316367947616234	0.0061290877408219655
                       	0.013046735741414128	0.23731482253696315	0.0076722498551001885
                       	0.013046735741414128	0.360463383316429	0.008646466735790522
                       	0.013046735741414128	0.49347663212929294	0.008979440171346999
                       	0.013046735741414128	0.6264898809421569	0.008646466735790522
                       	0.013046735741414128	0.7496384417216226	0.0076722498551001885
                       	0.013046735741414128	0.8537895847824235	0.0061290877408219655
                       	0.013046735741414128	0.9312212963507076	0.004131688397056032
                       	0.013046735741414128	0.9762096158035665	0.0018315376345417456
                       	0.06746831665550773	0.012166494443091671	0.004645929897132954
                       	0.06746831665550773	0.06291634290317988	0.010414376646895578
                       	0.06746831665550773	0.14948036746912413	0.01526682703373161
                       	0.06746831665550773	0.2641883734516979	0.018763597982262337
                       	0.06746831665550773	0.39685082270357663	0.020593327540725605
                       	0.06746831665550773	0.5356808606409157	0.020593327540725605
                       	0.06746831665550773	0.6683433098927944	0.018763597982262337
                       	0.06746831665550773	0.7830513158753682	0.01526682703373161
                       	0.06746831665550773	0.8696153404413125	0.010414376646895578
                       	0.06746831665550773	0.9203651889014006	0.004645929897132954
                       	0.16029521585048778	0.013367999605810503	0.007475937924006081
                       	0.16029521585048778	0.06884273181476093	0.016616728377363568
                       	0.16029521585048778	0.16232692882509292	0.023971996934294904
                       	0.16029521585048778	0.2837138166202382	0.028730912723790195
                       	0.16029521585048778	0.4198523920747561	0.030376714827674876
                       	0.16029521585048778	0.555990967529274	0.028730912723790195
                       	0.16029521585048778	0.6773778553244193	0.023971996934294904
                       	0.16029521585048778	0.7708620523347512	0.016616728377363568
                       	0.16029521585048778	0.8263367845437017	0.007475937924006081
                       	0.2833023029353764	0.014230084199160775	0.009767685091002417
                       	0.2833023029353764	0.07286433368684568	0.021457861531466595
                       	0.2833023029353764	0.17002491457238442	0.030269999351765227
                       	0.2833023029353764	0.29261525561305946	0.034995872838576136
                       	0.2833023029353764	0.4240824414515642	0.034995872838576136
                       	0.2833023029353764	0.5466727824922392	0.030269999351765227
                       	0.2833023029353764	0.643833363377778	0.021457861531466595
                       	0.2833023029353764	0.7024676128654629	0.009767685091002417
                       	0.4255628305091844	0.014617153391652144	0.010990690348350176
                       	0.4255628305091844	0.0742370470729654	0.023741407497558403
                       	0.4255628305091844	0.170652314741006	0.0324097536182204
                       	0.4255628305091844	0.2872185847454078	0.03547639623285247
                       	0.4255628305091844	0.4037848547498096	0.0324097536182204
                       	0.4255628305091844	0.5002001224178502	0.023741407497558403
                       	0.4255628305091844	0.5598200160991634	0.010990690348350176
                       	0.5744371694908156	0.014369232340683444	0.010773237484994033
                       	0.5744371694908156	0.07208834622267984	0.022685431883877852
                       	0.5744371694908156	0.1620076871329107	0.029423393407949416
                       	0.5744371694908156	0.2635551433762738	0.029423393407949416
                       	0.5744371694908156	0.3534744842865046	0.022685431883877852
                       	0.5744371694908156	0.411193598168501	0.010773237484994033
                       	0.7166976970646236	0.013289732853664154	0.009036851233736988
                       	0.7166976970646236	0.06537635366120652	0.018255826435561825
                       	0.7166976970646236	0.1416511514676882	0.02169852634577794
                       	0.7166976970646236	0.21792594927416986	0.018255826435561825
                       	0.7166976970646236	0.2700125700817122	0.009036851233736988
                       	0.8397047841495122	0.01112959245341311	0.0061080694536620565
                       	0.8397047841495122	0.05289894054198958	0.01145117843103672
                       	0.8397047841495122	0.1073962753084982	0.01145117843103672
                       	0.8397047841495122	0.14916562339707468	0.0061080694536620565
                       	0.9325316833444923	0.007603791647410872	0.0028008974858567235
                       	0.9325316833444923	0.033734158327753866	0.004481435977370756
                       	0.9325316833444923	0.05986452500809686	0.0028008974858567235
                       	0.9869532642585859	0.002757099674531384	0.0004349217053601449
                       	0.9869532642585859	0.010289636066882744	0.0004349217053601449 ] ;
	end
    
	# Regla de cuadratura de 49 puntos. Formato matriz [ x y w ]
	function QR_cquts7()
        return [ 0.024798542682092667	0.025446043828620757	0.008169859511165197
                0.12594590281051804	0.025446043828620757	0.017648023709583658
                0.2895179791517823	0.025446043828620757	0.024091583463825398
                0.4872769780856896	0.025446043828620757	0.026371152675440677
                0.6850359770195968	0.025446043828620757	0.024091583463825398
                0.8486080533608612	0.025446043828620757	0.017648023709583658
                0.9497554134892865	0.025446043828620757	0.008169859511165197
                0.02215753943883603	0.12923440720030277	0.015768538755504602
                0.1125328751958891	0.12923440720030277	0.03406221923918308
                0.2586847994878376	0.12923440720030277	0.04649884946144249
                0.4353827963998486	0.12923440720030277	0.050898616117170954
                0.6120807933118596	0.12923440720030277	0.04649884946144249
                0.7582327176038082	0.12923440720030277	0.03406221923918308
                0.8486080533608612	0.12923440720030277	0.015768538755504602
                0.017886598669101614	0.29707742431130146	0.017376685809516536
                0.09084178237683892	0.29707742431130146	0.0375360387459829
                0.20882242827586442	0.29707742431130146	0.05124101288798444
                0.35146128784434927	0.29707742431130146	0.05608948768943627
                0.49410014741283415	0.29707742431130146	0.05124101288798444
                0.6120807933118596	0.29707742431130146	0.0375360387459829
                0.6850359770195968	0.29707742431130146	0.017376685809516536
                0.012723021914310378	0.5	0.0135298576894819
                0.06461720360015138	0.5	0.029226359273981557
                0.14853871215565073	0.5	0.039897344052779775
                0.25	0.5	0.043672469804248236
                0.35146128784434927	0.5	0.039897344052779775
                0.4353827963998486	0.5	0.029226359273981557
                0.4872769780856896	0.5	0.0135298576894819
                0.007559445159519142	0.7029225756886985	0.007343939776440036
                0.03839262482346386	0.7029225756886985	0.015863923133469366
                0.08825499603543704	0.7029225756886985	0.0216560808463864
                0.14853871215565073	0.7029225756886985	0.023705200416123274
                0.20882242827586442	0.7029225756886985	0.0216560808463864
                0.2586847994878376	0.7029225756886985	0.015863923133469366
                0.2895179791517823	0.7029225756886985	0.007343939776440036
                0.003288504389784726	0.8707655927996972	0.002340282821615119
                0.01670153200441367	0.8707655927996972	0.005055333774901658
                0.03839262482346386	0.8707655927996972	0.0069011124180097805
                0.06461720360015138	0.8707655927996972	0.007554102430792155
                0.09084178237683892	0.8707655927996972	0.0069011124180097805
                0.1125328751958891	0.8707655927996972	0.005055333774901658
                0.12594590281051804	0.8707655927996972	0.002340282821615119
                0.0006475011465280885	0.9745539561713792	0.0002133187207114732
                0.003288504389784726	0.9745539561713792	0.0004607978675360617
                0.007559445159519142	0.9745539561713792	0.0006290421221311745
                0.012723021914310378	0.9745539561713792	0.0006885627035231159
                0.017886598669101614	0.9745539561713792	0.0006290421221311745
                0.02215753943883603	0.9745539561713792	0.0004607978675360617
                0.024798542682092667	0.9745539561713792	0.0002133187207114732 ] ;
	end
                            
	# Nueva regla de cuadratura de 44 puntos
	function cqutm9()
		rule = [  1.985507175123191E-002 1.560378988162790E-002 2.015983497663207E-003
		1.985507175123191E-002 8.035663927218221E-002 4.480916044841641E-003
		1.985507175123191E-002 0.189476014677302 6.464359484621604E-003
		1.985507175123191E-002 0.331164789916112 7.747662769908149E-003
		1.985507175123191E-002 0.490072464124384 8.191474625434276E-003
		1.985507175123191E-002 0.648980138332656 7.747662769908149E-003
		1.985507175123191E-002 0.790668913571466 6.464359484621604E-003
		1.985507175123191E-002 0.899788288976586 4.480916044841641E-003
		1.985507175123191E-002 0.964541138367140 2.015983497663207E-003
		0.101666761293187 1.783647091104033E-002 5.055663745070170E-003
		0.101666761293187 9.133063094134081E-002 1.110639128725685E-002
		0.101666761293187 0.213115003430640 1.566747257514398E-002
		0.101666761293187 0.366773901111335 1.811354111938598E-002
		0.101666761293187 0.531559337595478 1.811354111938598E-002
		0.101666761293187 0.685218235276173 1.566747257514398E-002
		0.101666761293187 0.807002607765473 1.110639128725685E-002
		0.101666761293187 0.880496767795773 5.055663745070170E-003
		0.237233795041836 1.940938228235618E-002 7.745946956361961E-003
		0.237233795041836 9.857563833019303E-002 1.673231410555364E-002
		0.237233795041836 0.226600619520678 2.284153446586376E-002
		0.237233795041836 0.381383102479082 2.500282281756943E-002
		0.237233795041836 0.536165585437487 2.284153446586376E-002
		0.237233795041836 0.664190566627971 1.673231410555364E-002
		0.237233795041836 0.743356822675808 7.745946956361961E-003
		0.408282678752175 1.997947907913758E-002 9.191827856850984E-003
		0.408282678752175 0.100234137152044 1.935542449754594E-002
		0.408282678752175 0.225261107830170 2.510431683577024E-002
		0.408282678752175 0.366456213417655 2.510431683577024E-002
		0.408282678752175 0.491483184095780 1.935542449754594E-002
		0.408282678752175 0.571737842168687 9.191827856850984E-003
		0.591717321247825 1.915257191055202E-002 8.770885597453929E-003
		0.591717321247825 9.421749319819557E-002 1.771853503082167E-002
		0.591717321247825 0.204141339376088 2.105991205229386E-002
		0.591717321247825 0.314065185553979 1.771853503082167E-002
		0.591717321247825 0.389130106841623 8.770885597453929E-003
		0.762766204958164 1.647157989702492E-002 6.471997505236908E-003
		0.762766204958164 7.828940091495819E-002 1.213345702759751E-002
		0.762766204958164 0.158944394126877 1.213345702759751E-002
		0.762766204958164 0.220762215144811 6.471997505236908E-003
		0.898333238706813 1.145801331145764E-002 3.140105492486528E-003
		0.898333238706813 5.083338064659329E-002 5.024168787978471E-003
		0.898333238706813 9.020874798172894E-002 3.140105492486528E-003
		0.980144928248768 4.195870365439417E-003 5.024749628293684E-004
		0.980144928248768 1.565920138579250E-002 5.024749628293684E-004 ] ;
		return 2*rule[:,3], rule[:,1], rule[:,2]
	end

	# Nueva regla de cuadratura de orden n=11 y 65 (11*12/2 -1 ) puntos
	function cqutm11()
		rule = [ 0.010743648455019322	0.013046735741414128	0.0009157688172708728
		0.05573196790787835	0.013046735741414128	0.002065844198528016
		0.13316367947616234	0.013046735741414128	0.0030645438704109827
		0.23731482253696315	0.013046735741414128	0.0038361249275500942
		0.360463383316429	0.013046735741414128	0.004323233367895261
		0.49347663212929294	0.013046735741414128	0.0044897200856734995
		0.6264898809421569	0.013046735741414128	0.004323233367895261
		0.7496384417216226	0.013046735741414128	0.0038361249275500942
		0.8537895847824235	0.013046735741414128	0.0030645438704109827
		0.9312212963507076	0.013046735741414128	0.002065844198528016
		0.9762096158035665	0.013046735741414128	0.0009157688172708728
		0.012166494443091671	0.06746831665550773	0.002322964948566477
		0.06291634290317988	0.06746831665550773	0.005207188323447789
		0.14948036746912413	0.06746831665550773	0.007633413516865805
		0.2641883734516979	0.06746831665550773	0.009381798991131169
		0.39685082270357663	0.06746831665550773	0.010296663770362802
		0.5356808606409157	0.06746831665550773	0.010296663770362802
		0.6683433098927944	0.06746831665550773	0.009381798991131169
		0.7830513158753682	0.06746831665550773	0.007633413516865805
		0.8696153404413125	0.06746831665550773	0.005207188323447789
		0.9203651889014006	0.06746831665550773	0.002322964948566477
		0.013367999605810503	0.16029521585048778	0.0037379689620030405
		0.06884273181476093	0.16029521585048778	0.008308364188681784
		0.16232692882509292	0.16029521585048778	0.011985998467147452
		0.2837138166202382	0.16029521585048778	0.014365456361895098
		0.4198523920747561	0.16029521585048778	0.015188357413837438
		0.555990967529274	0.16029521585048778	0.014365456361895098
		0.6773778553244193	0.16029521585048778	0.011985998467147452
		0.7708620523347512	0.16029521585048778	0.008308364188681784
		0.8263367845437017	0.16029521585048778	0.0037379689620030405
		0.014230084199160775	0.2833023029353764	0.004883842545501209
		0.07286433368684568	0.2833023029353764	0.010728930765733297
		0.17002491457238442	0.2833023029353764	0.015134999675882613
		0.29261525561305946	0.2833023029353764	0.017497936419288068
		0.4240824414515642	0.2833023029353764	0.017497936419288068
		0.5466727824922392	0.2833023029353764	0.015134999675882613
		0.643833363377778	0.2833023029353764	0.010728930765733297
		0.7024676128654629	0.2833023029353764	0.004883842545501209
		0.014617153391652144	0.4255628305091844	0.005495345174175088
		0.0742370470729654	0.4255628305091844	0.011870703748779202
		0.170652314741006	0.4255628305091844	0.0162048768091102
		0.2872185847454078	0.4255628305091844	0.017738198116426233
		0.4037848547498096	0.4255628305091844	0.0162048768091102
		0.5002001224178502	0.4255628305091844	0.011870703748779202
		0.5598200160991634	0.4255628305091844	0.005495345174175088
		0.014369232340683444	0.5744371694908156	0.005386618742497016
		0.07208834622267984	0.5744371694908156	0.011342715941938926
		0.1620076871329107	0.5744371694908156	0.014711696703974708
		0.2635551433762738	0.5744371694908156	0.014711696703974708
		0.3534744842865046	0.5744371694908156	0.011342715941938926	
		0.411193598168501	0.5744371694908156	0.005386618742497016
		0.013289732853664154	0.7166976970646236	0.004518425616868494
		0.06537635366120652	0.7166976970646236	0.009127913217780913
		0.1416511514676882	0.7166976970646236	0.01084926317288897
		0.21792594927416986	0.7166976970646236	0.009127913217780913
		0.2700125700817122	0.7166976970646236	0.004518425616868494
		0.01112959245341311	0.8397047841495122	0.0030540347268310283
		0.05289894054198958	0.8397047841495122	0.00572558921551836
		0.1073962753084982	0.8397047841495122	0.00572558921551836
		0.14916562339707468	0.8397047841495122	0.0030540347268310283
		0.007603791647410872	0.9325316833444923	0.0014004487429283617
		0.033734158327753866	0.9325316833444923	0.002240717988685378
		0.05986452500809686	0.9325316833444923	0.0014004487429283617
		0.002757099674531384	0.9869532642585859	0.00021746085268007246
		0.010289636066882744	0.9869532642585859	0.00021746085268007246 ]
		return 2*rule[:,3], rule[:,1], rule[:,2]
	end
	
	# Nueva regla de cuadratura de 49 puntos
	function cquts7()
		rule = [ 0.004084929755582598	0.024798542682092667	0.025446043828620757
		0.008824011854791829	0.12594590281051804	0.025446043828620757
		0.012045791731912699	0.2895179791517823	0.025446043828620757
		0.013185576337720339	0.4872769780856896	0.025446043828620757
		0.012045791731912699	0.6850359770195968	0.025446043828620757
		0.008824011854791829	0.8486080533608612	0.025446043828620757
		0.004084929755582598	0.9497554134892865	0.025446043828620757
		0.007884269377752301	0.02215753943883603	0.12923440720030277
		0.01703110961959154	0.1125328751958891	0.12923440720030277
		0.023249424730721245	0.2586847994878376	0.12923440720030277
		0.025449308058585477	0.4353827963998486	0.12923440720030277
		0.023249424730721245	0.6120807933118596	0.12923440720030277
		0.01703110961959154	0.7582327176038082	0.12923440720030277
		0.007884269377752301	0.8486080533608612	0.12923440720030277
		0.008688342904758268	0.017886598669101614	0.29707742431130146
		0.01876801937299145	0.09084178237683892	0.29707742431130146
		0.02562050644399222	0.20882242827586442	0.29707742431130146
		0.028044743844718136	0.35146128784434927	0.29707742431130146
		0.02562050644399222	0.49410014741283415	0.29707742431130146
		0.01876801937299145	0.6120807933118596	0.29707742431130146
		0.008688342904758268	0.6850359770195968	0.29707742431130146
		0.00676492884474095	0.012723021914310378	0.5
		0.014613179636990778	0.06461720360015138	0.5
		0.019948672026389887	0.14853871215565073	0.5
		0.021836234902124118	0.25	0.5
		0.019948672026389887	0.35146128784434927	0.5
		0.014613179636990778	0.4353827963998486	0.5
		0.00676492884474095	0.4872769780856896	0.5
		0.003671969888220018	0.007559445159519142	0.7029225756886985
		0.007931961566734683	0.03839262482346386	0.7029225756886985
		0.0108280404231932	0.08825499603543704	0.7029225756886985
		0.011852600208061637	0.14853871215565073	0.7029225756886985
		0.0108280404231932	0.20882242827586442	0.7029225756886985
		0.007931961566734683	0.2586847994878376	0.7029225756886985
		0.003671969888220018	0.2895179791517823	0.7029225756886985
		0.0011701414108075596	0.003288504389784726	0.8707655927996972
		0.002527666887450829	0.01670153200441367	0.8707655927996972
		0.0034505562090048902	0.03839262482346386	0.8707655927996972
		0.0037770512153960773	0.06461720360015138	0.8707655927996972
		0.0034505562090048902	0.09084178237683892	0.8707655927996972
		0.002527666887450829	0.1125328751958891	0.8707655927996972
		0.0011701414108075596	0.12594590281051804	0.8707655927996972
		0.0001066593603557366	0.0006475011465280885	0.9745539561713792
		0.00023039893376803085	0.003288504389784726	0.9745539561713792
		0.00031452106106558727	0.007559445159519142	0.9745539561713792
		0.00034428135176155797	0.012723021914310378	0.9745539561713792
		0.00031452106106558727	0.017886598669101614	0.9745539561713792
		0.00023039893376803085	0.02215753943883603	0.9745539561713792
		0.0001066593603557366	0.024798542682092667	0.9745539561713792 ]
		return 2*rule[:,1], rule[:,2], rule[:,3]
	end

	# Nueva regla de cuadratura de 36 puntos
	function cquts6()
		rule = [ 0.007090250380294403	0.0326251512704344	0.033765242898423975
               	0.014930088774692674	0.16367563308803143	0.033765242898423975
               	0.019364580664897574	0.3678363028983513	0.033765242898423975
               	0.019364580664897574	0.5983984542032248	0.033765242898423975
               	0.014930088774692674	0.8025591240135446	0.033765242898423975
               	0.007090250380294403	0.9336096058311416	0.033765242898423975
               	0.012834356987784673	0.028045569219587643	0.16939530676686776
               	0.027025574403730157	0.14070053681222652	0.16939530676686776
               	0.03505263253647307	0.3162032386884794	0.16939530676686776
               	0.03505263253647307	0.5144014545446529	0.16939530676686776
               	0.027025574403730157	0.6899041564209057	0.16939530676686776
               	0.012834356987784673	0.8025591240135446	0.16939530676686776
               	0.012411756545555715	0.020911138838373675	0.38069040695840156
               	0.026135695798562935	0.10490813849694561	0.38069040695840156
               	0.03389844475555802	0.23576522100824818	0.38069040695840156
               	0.03389844475555802	0.38354437203335034	0.38069040695840156
               	0.026135695798562935	0.5144014545446529	0.38069040695840156
               	0.012411756545555715	0.5983984542032248	0.38069040695840156
               	0.007629522783895958	0.012854104060050301	0.6193095930415985
               	0.016065645973334056	0.06448716826992217	0.6193095930415985
               	0.02083741778626618	0.14492518595015338	0.6193095930415985
               	0.02083741778626618	0.23576522100824818	0.6193095930415985
               	0.016065645973334056	0.3162032386884794	0.6193095930415985
               	0.007629522783895958	0.3678363028983513	0.6193095930415985
               	0.0026174663553111682	0.005719673678836332	0.8306046932331322
               	0.005511653743311724	0.028694769954641233	0.8306046932331322
               	0.00714870923542392	0.06448716826992217	0.8306046932331322
               	0.00714870923542392	0.10490813849694561	0.8306046932331322
               	0.005511653743311724	0.14070053681222652	0.8306046932331322
               	0.0026174663553111682	0.16367563308803143	0.8306046932331322
               	0.0002477700419507016	0.0011400916279895707	0.966234757101576
               	0.0005217345684031688	0.005719673678836332	0.966234757101576
               	0.0006766986645540992	0.012854104060050301	0.966234757101576
               	0.0006766986645540992	0.020911138838373675	0.966234757101576
               	0.0005217345684031688	0.028045569219587643	0.966234757101576
               	0.0002477700419507016	0.0326251512704344	0.966234757101576 ]
		return 2*rule[:,1], rule[:,2], rule[:,3]
	end

	# Regla de cuadratura de 64 puntos (8*8) para elementos fuera de la diagonal
	function cquts8()
		rule = [ 0.019460847876985345	0.019855071751231912	0.002510939334863195
		0.09964816045299504	0.019855071751231912	0.0055160857520927566
		0.2325235010194628	0.019855071751231912	0.0077813864114686096
		0.4001761968707655	0.019855071751231912	0.008996247611339948
		0.5799687313780026	0.019855071751231912	0.008996247611339948
		0.7476214272293052	0.019855071751231912	0.0077813864114686096
		0.880496767795773	0.019855071751231912	0.0055160857520927566
		0.9606840803717828	0.019855071751231912	0.002510939334863195
		0.017836470911040323	0.10166676129318664	0.005055663745070471
		0.09133063094134085	0.10166676129318664	0.011106391287256859
		0.21311500343064044	0.10166676129318664	0.015667472575154523
		0.3667739011113349	0.10166676129318664	0.018113541119385988
		0.5315593375954785	0.10166676129318664	0.018113541119385988
		0.6852182352761729	0.10166676129318664	0.015667472575154523
		0.8070026077654725	0.10166676129318664	0.011106391287256859
		0.880496767795773	0.10166676129318664	0.005055663745070471
		0.015144777728859223	0.2372337950418355	0.006055613217316468
		0.07754796968199158	0.2372337950418355	0.013303101880812214
		0.1809539215318839	0.2372337950418355	0.01876631018045021
		0.31142422942195	0.2372337950418355	0.021696181658028797
		0.4513419755362145	0.2372337950418355	0.021696181658028797
		0.5818122834262806	0.2372337950418355	0.01876631018045021
		0.6852182352761729	0.2372337950418355	0.013303101880812214
		0.7476214272293052	0.2372337950418355	0.006055613217316468
		0.011748589869822308	0.4082826787521751	0.005431069818802491
		0.06015798365234645	0.4082826787521751	0.011931091456556292
		0.14037534571161045	0.4082826787521751	0.0168308538167329
		0.2415879329831233	0.4082826787521751	0.019458554098075974
		0.3501293882647017	0.4082826787521751	0.019458554098075974
		0.4513419755362145	0.4082826787521751	0.0168308538167329
		0.5315593375954785	0.4082826787521751	0.011931091456556292
		0.5799687313780026	0.4082826787521751	0.005431069818802491
		0.008106481881409605	0.591717321247825	0.003747417313109325
		0.04150877764084019	0.591717321247825	0.00823240727522965
		0.09685844933022508	0.591717321247825	0.01161322448274914
		0.16669474576905183	0.591717321247825	0.013426327583334667
		0.2415879329831233	0.591717321247825	0.013426327583334667
		0.31142422942195	0.591717321247825	0.01161322448274914
		0.3667739011113349	0.591717321247825	0.00823240727522965
		0.4001761968707655	0.591717321247825	0.003747417313109325
		0.004710294022372689	0.7627662049581645	0.0018834029293789676
		0.024118791611195053	0.7627662049581645	0.004137500225493545
		0.05627987350995162	0.7627662049581645	0.005836654736538329
		0.09685844933022508	0.7627662049581645	0.006747896641453244
		0.14037534571161045	0.7627662049581645	0.006747896641453244
		0.1809539215318839	0.7627662049581645	0.005836654736538329
		0.21311500343064044	0.7627662049581645	0.004137500225493545
		0.2325235010194628	0.7627662049581645	0.0018834029293789676
		0.002018600840191588	0.8983332387068134	0.0005721629090432086
		0.010336130351845793	0.8983332387068134	0.0012569398338813879
		0.024118791611195053	0.8983332387068134	0.0017731295311512356
		0.04150877764084019	0.8983332387068134	0.0020499576123999526
		0.06015798365234645	0.8983332387068134	0.0020499576123999526
		0.07754796968199158	0.8983332387068134	0.0017731295311512356
		0.09133063094134085	0.8983332387068134	0.0012569398338813879
		0.09964816045299504	0.8983332387068134	0.0005721629090432086
		0.00039422387424656747	0.9801449282487681	508648050097809e-19
		0.002018600840191588	0.9801449282487681	0.00011174090202092253
		0.004710294022372689	0.9801449282487681	0.00015762973522682656
		0.008106481881409605	0.9801449282487681	0.0001822395205718679
		0.011748589869822308	0.9801449282487681	0.0001822395205718679
		0.015144777728859223	0.9801449282487681	0.00015762973522682656
		0.017836470911040323	0.9801449282487681	0.00011174090202092253
		0.019460847876985345	0.9801449282487681	508648050097809e-19 ]
		return 2*rule[:,3], rule[:,1], rule[:,2]
	end	
